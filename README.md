# Eccommerce-SQL-Script

-- This script was generated by a beta version of the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE public.activation_codes
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    user_id integer NOT NULL,
    code integer,
    is_verified boolean,
    verified_date timestamp with time zone,
    PRIMARY KEY (id)
);

CREATE TABLE public.admins_requests
(
    description character varying(255),
    first_name character varying(255),
    last_name character varying(255),
    phone_number character varying(255),
    id integer NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE public.brands
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    name character varying NOT NULL,
    image character varying,
    PRIMARY KEY (id)
);

CREATE TABLE public.campaign_banner_images
(
    id integer NOT NULL,
    campaign_banner_image character varying(255),
    campaign_id integer,
    PRIMARY KEY (id)
);

CREATE TABLE public.campaign_managements
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    campaign_details character varying(255) NOT NULL,
    campaign_expired_date date,
    campaign_name character varying(255) NOT NULL,
    coupon_code character varying(255) NOT NULL,
    discount_rate integer,
    campaign_banner_image character varying(255),
    current_category_id integer,
    PRIMARY KEY (id)
);

CREATE TABLE public.carts
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    user_id integer NOT NULL,
    product_id integer NOT NULL,
    quantity integer NOT NULL,
    price double precision NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE public.categories
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    name character varying(25) NOT NULL,
    image character varying,
    PRIMARY KEY (id)
);

CREATE TABLE public.colors
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    name character varying NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE public.comments
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    customer_id integer,
    product_id integer,
    star_count integer,
    description character varying NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE public.contact_forms
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    first_name character varying NOT NULL,
    last_name character varying NOT NULL,
    email character varying NOT NULL,
    message character varying,
    sended_date date,
    PRIMARY KEY (id)
);

CREATE TABLE public.coupon_codes
(
    id integer NOT NULL,
    campaign_id integer NOT NULL,
    coupon_code character varying NOT NULL,
    coupon_code_expired_date date,
    PRIMARY KEY (id)
);

CREATE TABLE public.customers
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    first_name character varying,
    last_name character varying,
    phone_number character varying,
    PRIMARY KEY (id)
);

CREATE TABLE public.email_verification_token
(
    id bigint NOT NULL,
    expiry_date timestamp without time zone,
    token character varying(255),
    user_id integer NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE public.favorites
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    customer_id integer NOT NULL,
    product_id integer NOT NULL,
    PRIMARY KEY (id)
);

CREATE TABLE public.product_images
(
    id integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    product_id integer,
    image1 character varying,
    image2 character varying,
    image3 character varying,
    image4 character varying,
    image5 character varying,
    PRIMARY KEY (id)
);

CREATE TABLE public.product_orders
(
    id integer NOT NULL,
    delivery_address character varying(255),
    order_date timestamp without time zone,
    payment_type character varying(255),
    user_id integer,
    product_id integer,
    quantity double precision,
    price double precision,
    order_number integer,
    PRIMARY KEY (id)
);

CREATE TABLE public.products
(
    id integer NOT NULL,
    description character varying(1000),
    name character varying(255),
    price double precision,
    units_in_stocks integer,
    category_id integer,
    color_id integer,
    body_size character varying,
    image_id integer,
    brand_id integer,
    PRIMARY KEY (id)
);

CREATE TABLE public.registered_cards
(
    id integer NOT NULL,
    card_number character varying(255),
    cvv character varying(255),
    expiration_date character varying(255),
    full_name character varying(255),
    user_id integer,
    PRIMARY KEY (id)
);

CREATE TABLE public.reset_password_tokens
(
    id integer NOT NULL,
    user_id integer,
    token character varying,
    starting_date timestamp without time zone,
    expiration_date timestamp without time zone,
    PRIMARY KEY (id)
);

CREATE TABLE public.roles
(
    id integer NOT NULL,
    name character varying(255),
    PRIMARY KEY (id)
);

CREATE TABLE public.user_roles
(
    user_id integer NOT NULL,
    role_id integer NOT NULL,
    PRIMARY KEY (user_id, role_id)
);

CREATE TABLE public.users
(
    id integer NOT NULL,
    created_at date,
    email character varying(255),
    password character varying(255),
    user_name character varying(255),
    enabled boolean,
    verification_email_token character varying(255),
    PRIMARY KEY (id)
);

ALTER TABLE public.activation_codes
    ADD FOREIGN KEY (user_id)
    REFERENCES public.users (id)
    NOT VALID;


ALTER TABLE public.admins_requests
    ADD FOREIGN KEY (id)
    REFERENCES public.users (id)
    NOT VALID;


ALTER TABLE public.campaign_banner_images
    ADD FOREIGN KEY (campaign_id)
    REFERENCES public.campaign_managements (id)
    NOT VALID;


ALTER TABLE public.carts
    ADD FOREIGN KEY (product_id)
    REFERENCES public.products (id)
    NOT VALID;


ALTER TABLE public.carts
    ADD FOREIGN KEY (user_id)
    REFERENCES public.users (id)
    NOT VALID;


ALTER TABLE public.comments
    ADD FOREIGN KEY (customer_id)
    REFERENCES public.customers (id)
    NOT VALID;


ALTER TABLE public.comments
    ADD FOREIGN KEY (product_id)
    REFERENCES public.products (id)
    NOT VALID;


ALTER TABLE public.coupon_codes
    ADD FOREIGN KEY (campaign_id)
    REFERENCES public.campaign_managements (id)
    NOT VALID;


ALTER TABLE public.customers
    ADD FOREIGN KEY (id)
    REFERENCES public.users (id)
    NOT VALID;


ALTER TABLE public.email_verification_token
    ADD FOREIGN KEY (user_id)
    REFERENCES public.users (id)
    NOT VALID;


ALTER TABLE public.favorites
    ADD FOREIGN KEY (customer_id)
    REFERENCES public.customers (id)
    NOT VALID;


ALTER TABLE public.favorites
    ADD FOREIGN KEY (product_id)
    REFERENCES public.products (id)
    NOT VALID;


ALTER TABLE public.product_orders
    ADD FOREIGN KEY (product_id)
    REFERENCES public.products (id)
    NOT VALID;


ALTER TABLE public.product_orders
    ADD FOREIGN KEY (user_id)
    REFERENCES public.customers (id)
    NOT VALID;


ALTER TABLE public.products
    ADD FOREIGN KEY (brand_id)
    REFERENCES public.brands (id)
    NOT VALID;


ALTER TABLE public.products
    ADD FOREIGN KEY (category_id)
    REFERENCES public.categories (id)
    NOT VALID;


ALTER TABLE public.products
    ADD FOREIGN KEY (color_id)
    REFERENCES public.colors (id)
    NOT VALID;


ALTER TABLE public.products
    ADD FOREIGN KEY (image_id)
    REFERENCES public.product_images (id)
    NOT VALID;


ALTER TABLE public.user_roles
    ADD FOREIGN KEY (role_id)
    REFERENCES public.roles (id)
    NOT VALID;


ALTER TABLE public.user_roles
    ADD FOREIGN KEY (user_id)
    REFERENCES public.users (id)
    NOT VALID;

END;
